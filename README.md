# Monitoring-App-with-Telegram-Bot

Этот проект состоит из двух компонентов:
1. **Приложение для мониторинга серверов** на C++, которое проверяет доступность серверов/IP-адресов из списка, записывает недоступные серверы в лог и отправляет уведомления через HTTP-запросы.
2. **Telegram-бот** на Python с использованием библиотеки aiogram, который получает уведомления о недоступных серверах и отправляет их в чат Telegram.

## Структура проекта

/server-monitor ├── Checker.cpp # Программа для мониторинга серверов (на C++) ├── servers.txt # Список серверов для мониторинга (формат: один сервер/IP-адрес на строку) ├── unavailable_servers.log # Лог с недоступными серверами

/telegram-bot   ├── main.py # Telegram-бот на Python (использует aiogram)     ├── requirements.txt # Зависимости Python для бота ├── .gitignore # Исключаемые файлы (например, виртуальные окружения, логи и т.д.)


## Запуск и настройка

### 1. Сборка и запуск приложения для мониторинга серверов (Checker.cpp)

#### Шаги для компиляции и запуска:
1. Скачайте или клонируйте репозиторий:
    ```bash
    git clone <url_вашего_репозитория>
    ```
2. Перейдите в директорию с приложением:
    ```bash
    cd server-monitor
    ```
3. Скомпилируйте программу:
    ```bash
    g++ Checker.cpp -o checker.exe -lwinhttp -lws2_32 -static-libgcc -static-libstdc++
    ```
4. Создайте файл `servers.txt` и добавьте список серверов или IP-адресов, которые нужно мониторить. Пример:
    ```
    192.168.1.1
    10.0.0.1
    example.com
    ```
5. Запустите программу:
    ```bash
    ./checker
    ```
   Программа будет проверять доступность серверов, указанных в `servers.txt`. В случае недоступности сервера, программа записывает событие в файл `unavailable_servers.log` и отправляет уведомление на сервер с использованием HTTP-запроса.

### 2. Установка и запуск Telegram-бота (main.py)

#### Шаги для установки зависимостей:
1. Перейдите в папку с Telegram-ботом:
    ```bash
    cd telegram-bot
    ```
2. Создайте и активируйте виртуальное окружение:
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Linux/Mac
    start venv\Scripts\activate.bat     # Для Windows
    ```
3. Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```

#### Настройка:
1. Получите токен для вашего бота в [BotFather](https://core.telegram.org/bots#botfather).
2. В файле `main.py` замените значение переменной `API_TOKEN` на ваш токен:
    ```python
    API_TOKEN = 'YOUR_BOT_API_TOKEN'
    CHAT_ID = 'YOUR_CHAT_ID'  # ID чата, куда будут отправляться уведомления
    ```
   Для получения вашего `CHAT_ID` можно использовать метод `/getchatid` с ботом.

#### Запуск бота:
1. Запустите бота:
    ```bash
    python main.py
    ```
   Бот будет слушать сервер на `localhost:5000` и принимать уведомления от приложения мониторинга.

### 3. Взаимодействие между приложениями

- **Приложение мониторинга серверов**:
  - Программа проверяет доступность серверов из списка в `servers.txt`.
  - При недоступности сервера она записывает событие в `unavailable_servers.log` и отправляет HTTP-запрос на `http://localhost:5000/notify` с данными о недоступном сервере.
  
- **Telegram-бот**:
  - Бот получает уведомления через API (HTTP-запросы) от программы мониторинга.
  - При получении уведомления бот отправляет сообщение в Telegram-чат о недоступности сервера.

## Команды бота

- `/start` — Начать мониторинг серверов. Бот начнёт отслеживание событий о недоступных серверах.
- `/stop` — Остановить мониторинг серверов. Бот прекратит отслеживание новых событий.

## Логирование

- Программа для мониторинга серверов записывает все события о недоступных серверах в файл `unavailable_servers.log`.
- Бот периодически проверяет этот файл и отправляет уведомления в Telegram-чат, если в файле появились новые записи.

## Технологии

- **C++ (Checker.cpp)**: Программа для мониторинга серверов с использованием утилиты `ping`.
- **Python (main.py)**: Telegram-бот с использованием библиотеки `aiogram` и веб-сервера `FastAPI` для получения уведомлений.
- **Логирование**: Все события о недоступных серверах записываются в файл `unavailable_servers.log`.

## Дополнительные возможности

- **Многоканальная отправка уведомлений**: В будущем можно расширить проект, добавив поддержку нескольких Telegram-каналов или ботов для уведомлений.
- **Автоматическое перезапуск приложение**: Можно использовать систему управления процессами, такую как `systemd`, или контейнеризацию с Docker для более удобного развертывания.

## Лицензия

Этот проект распространяется под лицензией MIT. Подробности см. в файле [LICENSE](LICENSE).
